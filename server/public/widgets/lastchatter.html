<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StreamFinity | Last Chatter</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',system-ui,sans-serif;background:transparent;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh;overflow:hidden}
.lc{display:flex;align-items:flex-start;gap:12px;padding:14px 20px;border-radius:14px;background:rgba(15,15,25,.85);-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.08);max-width:380px;min-width:200px;transition:opacity .3s,transform .3s}
.lc-avatar{width:42px;height:42px;border-radius:50%;flex-shrink:0;object-fit:cover;background:rgba(139,92,246,.15);display:flex;align-items:center;justify-content:center;font-size:20px;overflow:hidden}
.lc-avatar img{width:100%;height:100%;border-radius:50%;object-fit:cover}
.lc-body{min-width:0;flex:1}
.lc-top{display:flex;align-items:center;gap:6px;margin-bottom:3px}
.lc-name{font-size:13px;font-weight:700;color:rgba(139,92,246,1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.lc-time{font-size:10px;color:rgba(255,255,255,.3);margin-left:auto;flex-shrink:0}
.lc-msg{font-size:14px;font-weight:400;color:rgba(255,255,255,.85);line-height:1.4;word-break:break-word;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.lc.new{animation:slideIn .4s cubic-bezier(.22,1,.36,1)}
@keyframes slideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.lc-badge{font-size:10px;padding:1px 5px;border-radius:4px;font-weight:600;flex-shrink:0}
.lc-badge-mod{background:rgba(16,185,129,.2);color:#10b981}
.lc-badge-sub{background:rgba(245,158,11,.2);color:#f59e0b}
</style>
</head>
<body>
<div class="lc" id="lc">
    <div class="lc-avatar" id="avatar">üí¨</div>
    <div class="lc-body">
        <div class="lc-top"><span class="lc-name" id="name">Waiting...</span><span class="lc-time" id="time"></span></div>
        <div class="lc-msg" id="msg">Connect to TikTok LIVE to see chat</div>
    </div>
</div>
<script src="/widgets/sf-bridge.js"></script>
<script>
(function(){
'use strict';
var params = new URLSearchParams(location.search);
var showAvatar = params.get('avatar') !== '0';
var accentColor = params.get('color') || '#8b5cf6';

document.querySelector('.lc-name').style.color = accentColor;

function update(d) {
    var nameEl = document.getElementById('name');
    var msgEl = document.getElementById('msg');
    var timeEl = document.getElementById('time');
    var avatarEl = document.getElementById('avatar');
    var lc = document.getElementById('lc');

    nameEl.textContent = '@' + (d.uniqueId || 'viewer');
    msgEl.textContent = d.comment || '';

    var now = new Date();
    timeEl.textContent = now.getHours().toString().padStart(2,'0') + ':' + now.getMinutes().toString().padStart(2,'0');

    if (showAvatar && d.profilePictureUrl) {
        avatarEl.innerHTML = '<img src="' + d.profilePictureUrl + '" onerror="this.parentElement.textContent=\'üí¨\'">';
    }

    var badges = '';
    if (d.isModerator) badges += '<span class="lc-badge lc-badge-mod">MOD</span>';
    if (d.isSubscriber) badges += '<span class="lc-badge lc-badge-sub">SUB</span>';
    var topEl = nameEl.parentElement;
    topEl.querySelectorAll('.lc-badge').forEach(function(b){ b.remove(); });
    if (badges) nameEl.insertAdjacentHTML('afterend', badges);

    lc.classList.remove('new');
    void lc.offsetWidth;
    lc.classList.add('new');
}

SF.on('chat', function(d) { update(d); });

if (SF.preview) {
    var fakeChats = [
        { uniqueId: 'StreamFan', comment: 'This stream is amazing! üî•', profilePictureUrl: '', isModerator: false, isSubscriber: false },
        { uniqueId: 'ModHelper', comment: 'Welcome everyone to the stream!', profilePictureUrl: '', isModerator: true, isSubscriber: false },
        { uniqueId: 'SubKing', comment: 'Just subscribed! Love your content', profilePictureUrl: '', isModerator: false, isSubscriber: true },
        { uniqueId: 'ChatMaster', comment: 'Can we get some likes? ‚ù§Ô∏è', profilePictureUrl: '', isModerator: false, isSubscriber: false },
        { uniqueId: 'GiftQueen', comment: 'Sending gifts! üéÅüéÅüéÅ', profilePictureUrl: '', isModerator: false, isSubscriber: true },
    ];
    update(fakeChats[0]);
    var i = 1;
    setInterval(function() {
        update(fakeChats[i % fakeChats.length]);
        i++;
    }, 4000);
}
})();
</script>
</body>
</html>
