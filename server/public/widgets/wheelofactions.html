<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StreamFinity | Wheel Of Actions</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',system-ui,sans-serif;background:transparent;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh}
.woa{text-align:center;position:relative}
.wheel-wrap{position:relative;width:320px;height:320px;margin:0 auto}
canvas{width:320px;height:320px;filter:drop-shadow(0 4px 20px rgba(0,0,0,.4))}
.pointer{position:absolute;top:-8px;left:50%;transform:translateX(-50%);font-size:28px;z-index:2;filter:drop-shadow(0 2px 6px rgba(0,0,0,.5))}
.result{margin-top:16px;font-size:20px;font-weight:800;min-height:30px;background:linear-gradient(135deg,#8b5cf6,#3b82f6);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
.result.show{animation:resultIn .5s ease}
@keyframes resultIn{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}
.trigger{font-size:12px;color:rgba(255,255,255,.4);margin-top:8px}
</style>
</head>
<body>
<div class="woa">
    <div class="wheel-wrap">
        <div class="pointer">â–¼</div>
        <canvas id="cv" width="640" height="640"></canvas>
    </div>
    <div class="result" id="result"></div>
    <div class="trigger">Triggered by gifts or !spin command</div>
</div>
<script src="/widgets/sf-bridge.js"></script>
<script>
(function(){
'use strict';
var cv=document.getElementById('cv');
var ctx=cv.getContext('2d');
var segments=['Play Sound','Show Alert','Dance','Sing','Push-ups','Shoutout','Change Scene','Mystery'];
var colors=['#8b5cf6','#3b82f6','#10b981','#f59e0b','#ef4444','#ec4899','#6366f1','#14b8a6'];
var angle=0,spinning=false;

function draw(){
    var cx=320,cy=320,r=300;
    ctx.clearRect(0,0,640,640);
    var arc=Math.PI*2/segments.length;
    for(var i=0;i<segments.length;i++){
        var a=angle+i*arc;
        ctx.beginPath();ctx.moveTo(cx,cy);ctx.arc(cx,cy,r,a,a+arc);ctx.closePath();
        ctx.fillStyle=colors[i%colors.length];ctx.fill();
        ctx.strokeStyle='rgba(255,255,255,.1)';ctx.lineWidth=2;ctx.stroke();
        ctx.save();ctx.translate(cx,cy);ctx.rotate(a+arc/2);
        ctx.fillStyle='#fff';ctx.font='bold 22px Inter,sans-serif';ctx.textAlign='center';ctx.textBaseline='middle';
        ctx.fillText(segments[i],r*0.6,0);
        ctx.restore();
    }
    ctx.beginPath();ctx.arc(cx,cy,40,0,Math.PI*2);ctx.fillStyle='rgba(15,15,25,.9)';ctx.fill();
    ctx.strokeStyle='rgba(255,255,255,.15)';ctx.lineWidth=3;ctx.stroke();
    ctx.fillStyle='#fff';ctx.font='bold 18px Inter';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText('SPIN',cx,cy);
}

function spin(){
    if(spinning) return;
    spinning=true;
    document.getElementById('result').textContent='';
    var target=angle+Math.PI*8+Math.random()*Math.PI*4;
    var start=performance.now(),dur=4000;
    function frame(ts){
        var p=Math.min((ts-start)/dur,1);
        var ease=1-Math.pow(1-p,3);
        angle=angle+(target-angle)*ease;
        draw();
        if(p<1){requestAnimationFrame(frame);}
        else{
            spinning=false;
            var norm=((angle%(Math.PI*2))+(Math.PI*2))%(Math.PI*2);
            var arc=Math.PI*2/segments.length;
            var idx=Math.floor(((Math.PI*2-norm+Math.PI*1.5)%(Math.PI*2))/arc)%segments.length;
            var res=document.getElementById('result');
            res.textContent='ðŸŽ¯ '+segments[idx];
            res.classList.remove('show');void res.offsetWidth;res.classList.add('show');
        }
    }
    requestAnimationFrame(frame);
}

draw();
SF.on('gift',function(){spin();});
SF.on('wheelSpin',function(){spin();});
if(SF.preview){spin();setInterval(spin,7000);}
})();
</script>
</body>
</html>
